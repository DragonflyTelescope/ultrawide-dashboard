<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>UW Dashboard | Ultrawide Gallery</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight,alt,wide.css">
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight,alt,wide.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6.14/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/binary-search-bounds@2.0.5/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-array@3.2.4/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-axis@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-brush@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-chord@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-color@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-contour@4.0.2/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-delaunay@6.0.4/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-dispatch@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-drag@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-dsv@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-ease@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-fetch@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-force@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-format@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-geo@3.1.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-hierarchy@3.1.2/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-interpolate@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-path@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-polygon@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-quadtree@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-random@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-scale-chromatic@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-scale@4.0.2/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-selection@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-shape@3.2.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-time-format@4.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-time@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-timer@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-transition@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-zoom@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3@7.9.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/delaunator@5.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/htl@0.3.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/internmap@2.0.3/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/interval-tree-1d@1.0.4/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/isoformat@0.2.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/robust-predicates@3.0.2/+esm">
<link rel="modulepreload" href="https://cdn.skypack.dev/d3-geo-projection@4">
<script type="module">

import {define} from "./_observablehq/client.js";

define({id: "7741f2dc", inputs: ["FileAttachment","d3"], outputs: ["tiles_searched","events","parseTime","pt2","tagsToCount","tagCounts","perc","updateTagCounts"], files: [{"name":"./people_tiles.json","mimeType":"application/json","path":"./_file/people_tiles.json"},{"name":"./objects.json","mimeType":"application/json","path":"./_file/objects.json"},{"name":"./completion.json","mimeType":"application/json","path":"./_file/completion.json"}], body: (FileAttachment,d3) => {
let tiles_searched;
tiles_searched = FileAttachment("people_tiles.json").json();

let events;
const parseTime = d3.utcParse("%Y-%m-%dT%H:%M:%S.%L%Z");
const pt2 = d3.utcParse("%Y-%m-%dT%H:%M:%SZ");
const tagsToCount = ["LSB-LARGE", "LSB-SMALL", "HALO-FEATURES", "MERGER"];
const tagCounts = {};
tagsToCount.forEach(tag => tagCounts[tag] = 0);
events = FileAttachment("objects.json")
  .json()
  .then((data) => {
    data.forEach((d) => {
      d.udg = (d.tags && (d.tags.includes("LSB-LARGE"))) ? 1 : 0;
      d.udgcand = (d.tags && (d.tags.includes("LSB-SMALL"))) ? 1 : 0;
      d.udgall = (d.tags && (d.tags.includes("LSB-SMALL") || (d.tags.includes("LSB-LARGE") ))) ? 1 : 0;
      tagsToCount.forEach(tag => {
        if (d.tags && d.tags.includes(tag)) {
          tagCounts[tag]++;
        }
      });
      d.time = parseTime(d.time);
      d.n = d.n 
      d.ra = d.ra 
      d.dec = d.dec
    });
    // Update the DOM with the tag counts after all data processing is done
    updateTagCounts();
    return data;
  })

let perc; 
perc = FileAttachment("completion.json").json().then((data) => {
    data.forEach((d) => {
      d.time = pt2(d.time);
    });
    return data;
  });



function updateTagCounts() {
  // Update the DOM with the tag counts
  const priorityCount = document.querySelector("#priorityCount");
  const possibleCount = document.querySelector("#possibleCount");
  const haloCount = document.querySelector("#haloCount");
  const mergerCount = document.querySelector("#mergerCount");
  
  priorityCount.textContent = tagCounts["LSB-LARGE"];
  possibleCount.textContent = tagCounts["LSB-SMALL"];
  haloCount.textContent = tagCounts["HALO-FEATURES"];
  mergerCount.textContent = tagCounts["MERGER"];
}
return {tiles_searched,events,parseTime,pt2,tagsToCount,tagCounts,perc,updateTagCounts};
}});

define({id: "516d29ff", inline: true, inputs: ["resize","Plot","events","display"], body: async (resize,Plot,events,display) => {
display(await(
    resize((width) => Plot.plot({
      title: "Number of Objects found in Ultrawide",
      subtitle: "All Objects",
      width,
      y: {grid: true, label: "N"},
      marks: [
        Plot.ruleY([0]),
        Plot.lineY(events, {x: "time", y: "n", tip: true})
      ]
    }))
  
))
}});

define({id: "32567482", inline: true, inputs: ["resize","Plot","perc","display"], body: async (resize,Plot,perc,display) => {
display(await(
    resize((width) => Plot.plot({
      title: "Number of Tiles Searched",
      subtitle: "All Objects",
      width,
      y: {grid: true, label: "Percentage of Spring Tiles", domain: [0, 100]},
      marks: [
        Plot.ruleY([0]),
        Plot.lineY(perc, {x: "time", y: "percentage", tip: true}),
        Plot.ruleX([new Date("2024-03-14T00:00:00Z")], {stroke: "red",strokeWidth: 6}),
        Plot.ruleX([new Date("2024-04-08T00:00:00Z")], {stroke: "red",strokeWidth: 6}),
      ]
    }))
  
))
}});

define({id: "8faf347b", inputs: ["html","FileAttachment","parseTime"], outputs: ["Gallery","objects","muybridge","filenames","imagesData","imagesArray","mostRecentImages","gallery"], files: [{"name":"./objects.json","mimeType":"application/json","path":"./_file/objects.json"},{"name":"./data/Archive.zip","mimeType":"application/zip","path":"./_file/data/Archive.zip"}], body: async (html,FileAttachment,parseTime) => {
function Gallery(imagesData) {
  if (!Array.isArray(imagesData)) {
    return html`<div>No images to display</div>`;
  }

  return html`<div style="
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-gap: 1rem;
  ">
    ${imagesData.map((i) => (i.style = 'width: 100%; height: 100%;', i))}
  </div>`;
}
const objects =  await FileAttachment("objects.json").json();

// Load images from the zip file
const muybridge =await  FileAttachment("data/Archive.zip").zip();

// Get filenames from the zip file
const filenames = (await muybridge.filenames)
  .filter(filename => !filename.includes("__MACOSX/"));

// Initialize imagesData as an empty object
const imagesData = {};

for (const filename of filenames) {
  // Split the filename to extract the ID
  const id = filename.split(".")[0];
  // Find the corresponding object in objects based on ID
  const object = objects.find(obj => obj.id === id);
  if (object) {
    const file = muybridge.file(filename);
    const image = await file.image();
    // Assign tags to the image object if found in objects, otherwise, assign an empty array
    // Add the image object with its associated tags to imagesData
    imagesData[filename] = {
      image: image,
      time: parseTime(object.time),
      link: object.url,
      id: id,
    };
  }
}
const imagesArray = Object.values(imagesData);
imagesArray.sort((a, b) => b.time - a.time);

const mostRecentImages = imagesArray.slice(0, 8).map(obj => obj.image);
const gallery = Gallery(mostRecentImages)
return {Gallery,objects,muybridge,filenames,imagesData,imagesArray,mostRecentImages,gallery};
}});

define({id: "ce387d5e", inline: true, inputs: ["gallery","display"], body: async (gallery,display) => {
display(await(
gallery
))
}});

define({id: "e57ec981", inputs: ["d3","events","FileAttachment"], outputs: ["geoMollweide","positiveLongitudes","negativeLongitudes","udgEvents","udgEvents2","regularEvents","mw","groupedData","personCounts","events2","data","colorScale"], files: [{"name":"./mw.json","mimeType":"application/json","path":"./_file/mw.json"}], body: async (d3,events,FileAttachment) => {
const {geoMollweide} = await import("https://cdn.skypack.dev/d3-geo-projection@4");
const positiveLongitudes = d3.range(180, 19, -20); // From +180 to +20, decreasing leftward
const negativeLongitudes = d3.range(0, -181, -20).map(value => 360 + value); 
const udgEvents = events.filter(event => event.udg === 1);
const udgEvents2 = events.filter(event => event.udgcand === 1);
const regularEvents = events.filter(event => event.udgall !== 1);
let mw;
mw =  FileAttachment("mw.json").json();

const groupedData = d3.group(events, d => d.person);

// Count number of objects added by each person
const personCounts = Array.from(groupedData, ([person, data]) => ({person, count: data.length}));

// Sort the counts by the number of objects added in descending order
personCounts.sort((a, b) => b.count - a.count);

// Prepare data for plotting
const events2 = personCounts.map(d => ({person: d.person, number: d.count}));
const data = Array.from({ length: 10 }, (_, i) => ({ label: `Bar ${i}`, value: i }));
const colorScale = d3.scaleOrdinal(d3.schemeCategory10);
return {geoMollweide,positiveLongitudes,negativeLongitudes,udgEvents,udgEvents2,regularEvents,mw,groupedData,personCounts,events2,data,colorScale};
}});

define({id: "7cf0d32c", inline: true, inputs: ["Plot","geoMollweide","regularEvents","udgEvents2","udgEvents","mw","d3","display"], body: async (Plot,geoMollweide,regularEvents,udgEvents2,udgEvents,mw,d3,display) => {
display(await(
Plot.plot({
  width:1600,
projection: {
  type:({width, height}) => geoMollweide().rotate([90, 0]).fitSize([width, height], {type:"Sphere"}),
},
 marks: [
    Plot.graticule(),
    Plot.sphere(),
    Plot.dot(regularEvents, { x: 'ra', y: 'dec', r: 3, stroke: "gray" ,opacity:0.5,tip:true}), // Plot regular events with blue border color
    Plot.dot(udgEvents2, { x: 'ra', y: 'dec', r: 7, stroke: "orange", symbol: "square" ,tip:true}), 
    Plot.dot(udgEvents, { x: 'ra', y: 'dec', r: 10, stroke: "black", symbol: "square", fill:"red",opacity:0.5,tip:true}), 
    Plot.dot(await mw, { x: 'ra', y: 'dec', r: 1, stroke: "steelblue", symbol: "square"}), 
    Plot.text(d3.range(-80, 90, 20), {
       style: { fontSize: '40px' },
      x: 310,
      y: Plot.identity,
      fill: "currentColor",
      stroke: "var(--theme-background)",
    }),
    Plot.text(d3.range(-180, 181, 20), {
      x: d => {
        // Adjust x-coordinate to increase to the left with 0/360 at the center
        const newX = (d < 0) ? -d : 360 - d;
        return newX;
      },
      y: 0,
      text: d => {
        // Calculate the longitude label based on x-coordinate
        const longitude = (d + 360) % 360; // Convert negative longitudes to positive
        return longitude.toString(); // Return the longitude label as a string
      },
      style: { fontSize: '40px' },
      fill: "currentColor",
      stroke: "var(--theme-background)",
    }),
  ]
})
))
}});

define({id: "9e50a659", inline: true, inputs: ["resize","Plot","events2","display"], body: async (resize,Plot,events2,display) => {
display(await(
  resize((width) => Plot.plot({
  x: {
    axis: "top",
    grid: true,
  },
  marks: [
    Plot.ruleX([0]),
    Plot.barX(events2, {x: "number", y: "person", sort: {y: "x", reverse: true},tip:true}),
  ],
  marginLeft: 100, // Increase or decrease as needed
}))
))
}});

define({id: "94ba9578", inline: true, inputs: ["resize","Plot","tiles_searched","display"], body: async (resize,Plot,tiles_searched,display) => {
display(await(
  resize((width) => Plot.plot({
  x: {
    axis: "top",
    grid: true,
  },
  marks: [
    Plot.ruleX([0]),
    Plot.barX(tiles_searched, {x: "Ntiles", y: "person", sort: {y: "x", reverse: true},tip:true})
  ],
  marginLeft: 100, // Increase or decrease as needed
}))
))
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link observablehq-link-active"><a href="./">Ultrawide Gallery</a></li>
  </ol>
  <ol>
    <li class="observablehq-link"><a href="./02_UDG-Priority">Priority UDG Candidates</a></li>
    <li class="observablehq-link"><a href="./03_UDG-POSSIBLE">Possible UDGs</a></li>
    <li class="observablehq-link"><a href="./04_mergers">Merger Candidates</a></li>
    <li class="observablehq-link"><a href="./05_halo_outskirts">Halo Outskirts Systems</a></li>
    <li class="observablehq-link"><a href="./06_dwarfs">Clumpy / Blue / Dwarfs</a></li>
    <li class="observablehq-link"><a href="./07_spiral">Spirals of Interest</a></li>
    <li class="observablehq-link"><a href="./08_rings">Ring Systems</a></li>
    <li class="observablehq-link"><a href="./09_Cirrus">Cirrus</a></li>
    <li class="observablehq-link"><a href="./10_weird">Weird Stuff</a></li>
    <li class="observablehq-link"><a href="./11_other">Other</a></li>
  </ol>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),o=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?o.checked=r==="true":o.indeterminate=!0;for(const t of document.querySelectorAll("#observablehq-sidebar summary")){const s=t.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${t.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<style>

.hero {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: var(--sans-serif);
  margin: 4rem 0 6rem;
  text-wrap: balance;
  text-align: center;
}

.hero h1 {
  margin: 2rem 0;
  max-width: none;
  font-size: 14vw;
  font-weight: 900;
  line-height: 1;
  background: linear-gradient(30deg, var(--theme-foreground-focus), currentColor);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero h2 {
  margin: 0;
  max-width: 34em;
  font-size: 20px;
  font-style: initial;
  font-weight: 500;
  line-height: 1.5;
  color: var(--theme-foreground-muted);
}

.hero h5 {
  margin: 0;
  max-width: 34em;
  font-size: 13px;
  font-style: initial;
  font-weight: 500;
  line-height: 1.5;
  color: var(--theme-foreground-muted);
  margin-top:15px;
}

@media (min-width: 640px) {
  .hero h1 {
    font-size: 90px;
  }
}

</style>
<div class="hero">
  <h1>Ultrawide Dashboard</h1>
  <h2>Objects found / categorized in <code>Tileviewer</code> from the Dragonfly Ultrawide Survey</h2>
  <h5>Last updated: 2024-03-24 00:39:47 UTC</h5>
</div>
<div id="cell-7741f2dc" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-4">
  <div class="card">
    <h2>Priority UDG Candidates</h2>
    <span class="big" id="priorityCount">0</span>
  </div>
  <div class="card">
    <h2>Possible UDG Candidates</h2>
    <span class="big" id="possibleCount">0</span>
  </div>
  <div class="card">
    <h2>Halo Features (disturbed outskirts)</h2>
    <span class="big" id="haloCount">0</span>
  </div>
  <div class="card">
    <h2>Merger</h2>
    <span class="big" id="mergerCount">0</span>
  </div>
</div>
<span>  <div class="card"><span id="cell-516d29ff" class="observablehq--loading"></span></div>
  <div class="card"><span id="cell-32567482" class="observablehq--loading"></span></div>
</span><div id="cell-8faf347b" class="observablehq observablehq--block"></div>
<div class="card">
<h1>Latest UW Objects</h1>
<span id="cell-ce387d5e" class="observablehq--loading"></span>
</div>
<div id="cell-e57ec981" class="observablehq observablehq--block"></div>
<div class="card">
<h1>On Sky Locations</h1>
<span id="cell-7cf0d32c" class="observablehq--loading"></span>
</div>
<span><h1>Leaderboards 😉</h1>
<div class="grid grid-cols-2">
<div class="card">
<h2>Objects Added</h2>
<span id="cell-9e50a659" class="observablehq--loading"></span>
</div>
<div class="card">
<h2>Tiles Checked</h2>
<span id="cell-94ba9578" class="observablehq--loading"></span>
</div>
</div></span></main>
<footer id="observablehq-footer">
<div>Built with <a href="https://observablehq.com/" target="_blank">Observable</a> on <a title="2024-03-23T20:39:20">Mar 23, 2024</a>.</div>
</footer>
</div>
